!function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};t.m=e,t.c=r,t.p="/",t(0)}([function(e,t,r){e.exports=r(14)},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t,i){if(r(this,e),!t.getAutoIncrementedId){var n=0;t.getAutoIncrementedId=function(){return n+=1}}t.collisionGroups||(t.collisionGroups={}),t.collisionGroups[i]||(t.collisionGroups[i]=[]),this.id=t.getAutoIncrementedId(),t.collisionGroups[i].push(this),this.name=i,this.collidesWith=[],this.antiCollisionFrames=[],this.g=t,t.things||(t.things=[]),t.things.push(this)}return i(e,[{key:"getPreviousPosition",value:function(){return{x:this.sprite.x-this.sprite.vx,y:this.sprite.y-this.sprite.vy}}},{key:"handleCollisions",value:function(){var e=this,t=this.g;this.collidesWith.forEach(function(r){t.collisionGroups[r].forEach(function(r){e.sprite.visible&&r.sprite.visible&&e.sprite!==r.sprite&&t.hitTestRectangle(e.sprite,r.sprite)&&!e.antiCollisionFrames[r.id]&&!r.antiCollisionFrames[e.id]&&(e.antiCollisionFrames[r.id]=10,r.antiCollisionFrames[e.id]=10,e.handleCollision(r),r.handleCollision(e))})})}},{key:"handleCollision",value:function(e){}},{key:"remove",value:function(){this.g.remove(this.sprite)}},{key:"update",value:function(){var e=this;Object.keys(this.antiCollisionFrames).forEach(function(t){e.antiCollisionFrames[t]-=1,0===e.antiCollisionFrames[t]&&delete e.antiCollisionFrames[t]}),this.handleCollisions()}}]),e}();t.default=n},function(e,t){"use strict";function r(e,t){var r=e.keyboard;switch(t){case 1:return{up:r(38),left:r(37),down:r(40),right:r(39),action:r(13)};case 2:return{up:r(87),left:r(65),down:r(83),right:r(68),action:r(32)};case 3:return{up:r(84),left:r(70),down:r(71),right:r(72),action:r(89)};case 4:return{up:r(73),left:r(74),down:r(75),right:r(76),action:r(79)};default:throw e.pause(),new Error("Invalid layer number: "+t)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getPlayerControls=r},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MODS=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},u=r(1),c=i(u),h=r(9),f=i(h),p=r(4),d=i(p),g=r(10),v=i(g),y=r(7),m=i(y),b=(r(11),{stickyball:"#ffaa00",powerball:"#b50000",growball:"#00dd01",shrinkball:"#ffc1c1",mirrorball:"#822389"}),w=(t.MODS=Object.keys(b),function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"ball"));return i.color=r,i.createSprite(),i.edgeBounces=0,i.collidesWith=["paddle","block","pit"],i.mod=null,i.mirroring=null,i}return a(t,e),s(t,[{key:"changeMod",value:function(e){this.mod=e,this.mirroring=null,this.prevMirroring=0}},{key:"createSprite",value:function(){this.sprite=this.g.circle(8,d.default[this.color].fill,this.mod?b[this.mod]:d.default[this.color].stroke,this.mod?8:3)}},{key:"recreateSprite",value:function(){var e=this.sprite;this.remove(),this.createSprite(),this.sprite.x=e.x,this.sprite.y=e.y,this.sprite.vx=e.vx,this.sprite.vy=e.vy}},{key:"bounceOffBounds",value:function(){var e=!1;this.sprite.x<=0||this.sprite.x>=this.g.stage.width-this.sprite.width?(this.sprite.vx*=-1,e=!0):(this.sprite.y<=32||this.sprite.y>=this.g.stage.height-this.sprite.height)&&(this.sprite.vy*=-1,e=!0),e&&(this.edgeBounces+=1),this.edgeBounces>=2&&(this.changeBallColor("blank"),this.edgeBounces=0)}},{key:"releaseFromPit",value:function(e){this.createSprite();var t=[this.g.randomInt(2,3),this.g.randomInt(2,3)];switch(t[this.g.randomInt(0,1)]*=2,e.position){case"TOP LEFT":this.sprite.x=e.sprite.x+e.sprite.halfWidth,this.sprite.y=e.sprite.y+e.sprite.halfHeight,this.sprite.vx=t[0],this.sprite.vy=t[1];break;case"TOP RIGHT":this.sprite.x=e.sprite.x-e.sprite.halfWidth,this.sprite.y=e.sprite.y+e.sprite.halfHeight,this.sprite.vx=-1*t[0],this.sprite.vy=t[1];break;case"BOTTOM LEFT":this.sprite.x=e.sprite.x+e.sprite.halfWidth,this.sprite.y=e.sprite.y-e.sprite.halfHeight,this.sprite.vx=t[0],this.sprite.vy=-1*t[1];break;case"BOTTOM RIGHT":this.sprite.x=e.sprite.x-e.sprite.halfWidth,this.sprite.y=e.sprite.y-e.sprite.halfHeight,this.sprite.vx=-1*t[0],this.sprite.vy=-1*t[1];break;default:throw this.g.pause(),new Error("Invalid pit position: "+e.position)}this.antiCollisionFrames[e.id]=10}},{key:"changeBallColor",value:function(e){this.color=e,this.recreateSprite()}},{key:"bounceOff",value:function(e){this.edgeBounces=0;var t=this,r=t.getPreviousPosition(),i=e.getPreviousPosition();e instanceof v.default&&e.color!==this.color&&this.changeBallColor(e.color);var n=null;if(r.y+t.sprite.height<=i.y)n="top";else if(r.x+t.sprite.width<=i.x)n="left";else if(r.y>=i.y+e.sprite.height)n="bottom";else{if(!(r.x>=i.x+e.sprite.width))return;n="right"}"left"===n||"right"===n?(t.sprite.vx*e.sprite.vx>0?t.sprite.vx+=e.sprite.vx:t.sprite.vx=-1*t.sprite.vx+e.sprite.vx,t.sprite.vy+=e.sprite.vy,t.sprite.vx=Math.min(Math.abs(t.sprite.vx),6)*(t.sprite.vx<0?-1:1),t.sprite.vy=Math.min(Math.abs(t.sprite.vy),6)*(t.sprite.vy<0?-1:1)):(t.sprite.vy*e.sprite.vy>0?t.sprite.vy+=e.sprite.vy:t.sprite.vy=-1*t.sprite.vy+e.sprite.vy,t.sprite.vx+=e.sprite.vx,t.sprite.vy=Math.min(Math.abs(t.sprite.vy),6)*(t.sprite.vy<0?-1:1),t.sprite.vx=Math.min(Math.abs(t.sprite.vx),6)*(t.sprite.vx<0?-1:1))}},{key:"handleCollision",value:function(e){e instanceof v.default||e instanceof f.default&&"blank"!==e.color&&e.color!==this.color?e instanceof v.default&&"stickyball"===this.mod&&!e.caughtBall?(e.attachBall(this),this.changeMod(null),this.color=e.color,this.recreateSprite()):e instanceof f.default&&"powerball"===this.mod||(e instanceof v.default&&"mirrorball"===this.mod&&(this.mirroring=e.position),this.bounceOff(e)):e instanceof m.default&&(this.remove(),this.sprite.visible=!1,this.sprite.vx=0,this.sprite.vy=0)}},{key:"setMirrorDirection",value:function(e){if(this.mirroring){"top"===this.mirroring||"bottom"===this.mirroring?this.sprite.vx+=0===e?2*this.prevMirroring:2*e:this.sprite.vy+=0===e?2*this.prevMirroring:2*e,this.prevMirroring=e}}},{key:"update",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),this.sprite.visible&&(this.bounceOffBounds(),this.g.move(this.sprite))}}]),t}(c.default));t.default=w},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={blank:{stroke:"#000000",fill:"#ffffff"},blue:{stroke:"#0000ff",fill:"#0088ff"},red:{stroke:"#000000",fill:"#ff0000"},yellow:{stroke:"#000000",fill:"#fff000"},green:{stroke:"#000000",fill:"#4cff00"}}},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),n=function(){function e(t){r(this,e),this.g=t,this.texts=[]}return i(e,[{key:"clear",value:function(){this.g.remove(this.texts)}},{key:"createText",value:function(e,t,r,i,n){var o=this.g.text(e,t+"px monospace",r,i,n);return this.texts.push(o),o}},{key:"createHorizontallyCenteredTexts",value:function(e,t,r,i,n){var o=this.g,a=.2*t,s=1===e.length?e[0].length:e.reduce(function(e,t){return e.length>t.length?e.length:t.length}),l=e.map(function(e,l){return o.text(e,t+"px monospace",r,o.stage.halfWidth-s/2*((t+a)/2),i+n*l)});return this.texts.push.apply(this.texts,l),l}},{key:"createHorizontallyCenteredText",value:function(e,t,r,i){var n=.2*t,o=this.g,a=o.text(e,t+"px monospace",r,o.stage.halfWidth-e.length/2*((t+n)/2),i);return this.texts.push(a),a}}]),e}();t.default=n},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.HUD_HEIGHT=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},l=r(1),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=90,h=t.HUD_HEIGHT=32,f=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t);var o=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"hud"));if(o.sprite=e.rectangle(768,h-1,"#aaaaaa","#000000",0,0),"function"!=typeof r.onTimerReachesZero)throw e.pause(),new"Must specify onTimerReachesZero callback";return o.onTimerReachesZero=r.onTimerReachesZero,o.timerFrames=60*(c+1),o.timerText=e.text(Math.ceil(o.timerFrames/60),"24px sans-serif","#ffffff",o.g.stage.halfWidth-12,0),o}return o(t,e),a(t,[{key:"updateTimerText",value:function(){this.timerText.content=Math.floor(this.timerFrames/60)}},{key:"update",value:function(){s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),this.timerFrames-=1,this.updateTimerText(),0===this.timerText.content&&this.onTimerReachesZero()}}]),t}(u.default);t.default=f},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PIT_SIZE=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},u=r(1),c=i(u),h=r(3),f=i(h),p=r(6),d=t.PIT_SIZE=32,g=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"pit")),a=void 0,s=void 0;switch(r){case"TOP LEFT":a=0,s=p.HUD_HEIGHT;break;case"TOP RIGHT":a=e.stage.width-d,s=p.HUD_HEIGHT;break;case"BOTTOM LEFT":a=0,s=e.stage.height-d;break;case"BOTTOM RIGHT":a=e.stage.width-d,s=e.stage.height-d;break;default:throw e.pause(),new Error("Invalid pit position: "+r)}return i.sprite=e.rectangle(32,32,"#000000","#000000",0,a,s),i.position=r,i.lostBallTimers=[],i}return a(t,e),s(t,[{key:"handleCollision",value:function(e){e instanceof f.default&&this.lostBallTimers.push({ball:e,frames:60*this.g.randomInt(2,5)})}},{key:"releaseModifiedBall",value:function(e){var t=h.MODS.concat(null);e.changeMod(h.MODS[this.g.randomInt(0,t.length-1)]);var r=this.g.collisionGroups.pit[this.g.randomInt(0,this.g.collisionGroups.pit.length-1)];e.releaseFromPit(r)}},{key:"update",value:function(){var e=this;l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this),this.lostBallTimers.forEach(function(t,r){t.frames-=1,0===t.frames&&(e.releaseModifiedBall(t.ball),delete e.lostBallTimers[r])})}}]),t}(c.default);t.default=g},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=i(n),a=r(9),s=i(a),l=r(6),u=i(l),c=r(10),h=i(c),f=r(7),p=i(f),d=r(17),g=i(d);t.default=function(e){e.things=[],e.collisionGroups={};for(var t=[],r=128;r<=608;r+=32)for(var i=128;i<=608;i+=32)t.push(new s.default(e,{x:r,y:i}));var n=[];2===e.globals.players||e.globals.teams?(n=[{position:"bottom",color:"blue"},{position:"right",color:"blue"},{position:"top",color:"red"},{position:"left",color:"red"}],2===e.globals.players?(n[0].player=1,n[1].player=1,n[2].player=2,n[3].player=2):e.globals.teams&&(n[0].player=1,n[1].player=2,n[2].player=3,n[3].player=4),n[e.randomInt(0,1)].startWithBall=!0,n[e.randomInt(2,3)].startWithBall=!0):4===e.globals.players&&(n=[{position:"bottom",color:"blue",player:1,startWithBall:!0},{position:"right",color:"red",player:2,startWithBall:!0},{position:"top",color:"yellow",player:3,startWithBall:!0},{position:"left",color:"green",player:4,startWithBall:!0}]),n.forEach(function(t){var r=new h.default(e,t);if(t.startWithBall){var i=new o.default(e,t.color);r.attachBall(i)}});new u.default(e,{onTimerReachesZero:function(){e.state=(0,g.default)(e)}});return new p.default(e,"TOP LEFT"),new p.default(e,"TOP RIGHT"),new p.default(e,"BOTTOM LEFT"),new p.default(e,"BOTTOM RIGHT"),function(){e.things.forEach(function(e){return e.update()})}}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=r(1),u=i(l),c=r(3),h=i(c),f=r(4),p=i(f),d=function(e){function t(e,r){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"block"));return i.color="blank",i.position=r,i.createSprite(),i}return a(t,e),s(t,[{key:"createSprite",value:function(){this.sprite=this.g.rectangle(32,32,p.default[this.color].fill,p.default[this.color].stroke,2,this.position.x,this.position.y),"blank"===this.color?this.sprite.alpha=0:this.sprite.alpha=.5}},{key:"handleCollision",value:function(e){if(e instanceof h.default){var t=e;"blank"===this.color&&(this.g.remove(this.sprite),this.color=t.color,this.createSprite()),this.color!==t.color&&(this.g.remove(this.sprite),this.color=t.color,this.createSprite())}}}]),t}(u.default);t.default=d},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PADDLE_LENGTH=t.BOTTOM=t.TOP=t.RIGHT=t.LEFT=void 0;var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),l=function e(t,r,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},u=r(1),c=i(u),h=r(3),f=i(h),p=r(4),d=i(p),g=r(2),v=r(6),y=r(7),m=t.LEFT="left",b=t.RIGHT="right",w=t.TOP="top",x=t.BOTTOM="bottom",_=t.PADDLE_LENGTH=64,O=function(e){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"paddle"));switch(r.length||(r.length=_),i.length=r.length,i.position=r.position,i.color=r.color,i.player=r.player,i.createSprite(),r.position){case w:e.stage.putTop(i.sprite,16,48);break;case b:e.stage.putRight(i.sprite,-1*i.sprite.width,-32);break;case x:e.stage.putBottom(i.sprite,-16,-1*i.sprite.height);break;case m:e.stage.putLeft(i.sprite,i.sprite.width,32);break;default:throw i.g.pause(),new Error("invalid position")}return i.antiCollisionFrames={},i.initInput(),i.controls=(0,g.getPlayerControls)(e,i.player),i}return a(t,e),s(t,[{key:"attachBall",value:function(e){this.caughtBall=e,this.handleCaughtBall()}},{key:"createSprite",value:function(){this.sprite=this.g.rectangle([w,x].indexOf(this.position)>-1?this.length:16,[w,x].indexOf(this.position)>-1?16:this.length,d.default[this.color].fill,d.default[this.color].stroke,2)}},{key:"recreateSprite",value:function(){var e=this.sprite;this.remove(),this.createSprite(),this.sprite.x=e.x,this.sprite.y=e.y,this.sprite.vx=e.vx,this.sprite.vy=e.vy}},{key:"getMirroringBall",value:function(){var e=this;return this.g.collisionGroups.ball.find(function(t){return t.mirroring===e.position})}},{key:"applyToMirroredBall",value:function(e){var t=this.getMirroringBall();t&&t.setMirrorDirection(e)}},{key:"initVerticalControls",value:function(){var e=this;this.controls.up.press=function(){e.upArrowDown=!0,e.applyToMirroredBall(-1),e.sprite.vy=-8},this.controls.up.release=function(){e.upArrowDown=!1,e.applyToMirroredBall(0),e.controls.down.isDown||(e.sprite.vy=0)},this.controls.down.press=function(){e.downArrowDown=!0,e.applyToMirroredBall(1),e.sprite.vy=8},this.controls.down.release=function(){e.downArrowDown=!1,e.applyToMirroredBall(0),e.controls.up.isDown||(e.sprite.vy=0)}}},{key:"initHorizontalControls",value:function(){var e=this;this.controls.right.press=function(){e.rightArrowDown=!0,e.applyToMirroredBall(1),e.sprite.vx=8},this.controls.right.release=function(){e.rightArrowDown=!1,e.applyToMirroredBall(0),e.controls.left.isDown||(e.sprite.vx=0)},this.controls.left.press=function(){e.applyToMirroredBall(-1),e.leftArrowDown=!0,e.sprite.vx=-8},this.controls.left.release=function(){e.applyToMirroredBall(0),e.leftArrowDown=!1,e.controls.right.isDown||(e.sprite.vx=0)}}},{key:"initInput",value:function(){var e=this;this.controls=(0,g.getPlayerControls)(this.g,this.player),[w,x].indexOf(this.position)>-1&&this.initHorizontalControls(),[m,b].indexOf(this.position)>-1&&this.initVerticalControls(),this.controls.action.press=function(){e.caughtBall&&e.releaseBall()}}},{key:"releaseBall",value:function(){if(this.caughtBall){switch(this.position){case x:this.caughtBall.sprite.vy=-4,this.caughtBall.sprite.vx=this.sprite.vx;break;case w:this.caughtBall.sprite.vy=4,this.caughtBall.sprite.vx=this.sprite.vx;break;case m:this.caughtBall.sprite.vy=this.sprite.vy,this.caughtBall.sprite.vx=4;break;case b:this.caughtBall.sprite.vy=this.sprite.vy,this.caughtBall.sprite.vx=-4}this.caughtBall=null}}},{key:"handleCaughtBall",value:function(){if(this.caughtBall)switch(this.caughtBall.sprite.vx=0,this.caughtBall.sprite.vy=0,this.position){case w:this.sprite.putBottom(this.caughtBall.sprite);break;case m:this.sprite.putRight(this.caughtBall.sprite);break;case x:this.sprite.putTop(this.caughtBall.sprite);break;case b:this.sprite.putLeft(this.caughtBall.sprite)}}},{key:"handleCollision",value:function(e){e instanceof f.default&&("growball"===e.mod?(this.length=Math.min(this.length+8,256),this.recreateSprite()):"shrinkball"===e.mod&&(this.length=Math.max(this.length-8,16),this.recreateSprite()))}},{key:"update",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"update",this).call(this);var e=this.g;e.move(this.sprite),this.handleCaughtBall();var r=Object.assign({},e.stage.localBounds);this.position===w||this.position===x?(r.x=y.PIT_SIZE,r.width-=y.PIT_SIZE):this.position!==m&&this.position!==b||(r.y=y.PIT_SIZE+v.HUD_HEIGHT,r.height-=y.PIT_SIZE),e.contain(this.sprite,r)}}]),t}(c.default);t.default=O},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return Array(Math.max(0,e)).fill(t).join("")};t.rpad=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e+r(t-e.length)},t.lpad=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return r(t-e.length,i)+e}},function(e,t){GA.custom=function(e){function t(e){e.x+=0|e.vx,e.y+=0|e.vy}e.move=function(e){if(e instanceof Array==!1)t(e);else for(var r=0;r<e.length;r++)t(e[r])},e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.wait=function(e,t){return setTimeout(t,e)},e.contain=function(e,t,r,i){var n=t.x,o=t.y,a=t.width,s=t.height;r=r||!1;var l;return e.x<n&&(r&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=n,l="left"),e.y<o&&(r&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o,l="top"),e.x+e.width>a&&(r&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=a-e.width,l="right"),e.y+e.height>s&&(r&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=s-e.height,l="bottom"),l&&i&&i(l),l},e.hitTestRectangle=function(e,t,r){var i,n,o,a;return void 0===r&&(r=!1),!1,r?(o=e.gx+e.halfWidth-(t.gx+t.halfWidth),a=e.gy+e.halfHeight-(t.gy+t.halfHeight)):(o=e.centerX-t.centerX,a=e.centerY-t.centerY),i=e.halfWidth+t.halfWidth,n=e.halfHeight+t.halfHeight,Math.abs(o)<i&&Math.abs(a)<n}}},function(e,t){var r=r||{};r.VERSION="0.0.1",r.plugins=void 0,r.custom=void 0,r.create=function(e,t,i,n,o){function a(){if(requestAnimationFrame(a,d.canvas),void 0===d._fps)l();else{var e=Date.now(),t=e-d._startTime;for(t>1e3&&(t=d._frameDuration),d._startTime=e,d._lag+=t;d._lag>=d._frameDuration;)s(),l(),d._lag-=d._frameDuration;var r=d._lag/d._frameDuration;d.render(d.canvas,r)}}function s(){function e(t){t._previousX=t.x,t._previousY=t.y,t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}d.stage.children.forEach(function(t){e(t)})}function l(){if(d.buttons.length>0){d.canvas.style.cursor="auto";for(var e=d.buttons.length-1;e>=0;e--){var t=d.buttons[e];t.update(d.pointer,d.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(d.canvas.style.cursor="pointer")}}if(d.dragAndDrop&&d.pointer.updateDragAndDrop(),d.state&&!d.paused&&d.state(),0!==d.updateFunctions.length)for(var r=0;r<d.updateFunctions.length;r++){var i=d.updateFunctions[r];i()}}function u(e){e.x=0,e.y=0,e.vx=0,e.vy=0,e.width=0,e.height=0,e.scaleX=1,e.scaleY=1,e.pivotX=.5,e.pivotY=.5,e.rotation=0,e.visible=!0,e.parent=void 0,e.stage=!1,e.shadow=!1,e.shadowColor="rgba(100, 100, 100, 0.5)",e.shadowOffsetX=3,e.shadowOffsetY=3,e.shadowBlur=3,e.blendMode=void 0,e._alpha=1,e._draggable=void 0,e._layer=0,e._circular=!1,e._interactive=!1,e._previousX=void 0,e._previousY=void 0,e.children=[],e.addChild=function(t){t.parent&&t.parent.removeChild(t),t.parent=e,e.children.push(t)},e.removeChild=function(t){if(t.parent!==e)throw new Error(t+"is not a child of "+e);e.children.splice(e.children.indexOf(t),1)},e.swapChildren=function(t,r){var i=e.children.indexOf(t),n=e.children.indexOf(r);if(-1===i||-1===n)throw new Error(child+" Both objects must be a child of the caller "+e);t.childIndex=n,r.childIndex=i,e.children[i]=r,e.children[n]=t},e.add=function(t){var r=Array.prototype.slice.call(arguments);r.length>1?r.forEach(function(t){e.addChild(t)}):e.addChild(r[0])},e.remove=function(t){var r=Array.prototype.slice.call(arguments);r.length>1?r.forEach(function(t){e.removeChild(t)}):e.removeChild(r[0])},e.setPosition=function(t,r){e.x=t,e.y=r};var t=e;e.putCenter=function(r,i,n){i=i||0,n=n||0,r.x=t.x+t.halfWidth-r.halfWidth+i,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.putTop=function(r,i,n){i=i||0,n=n||0,r.x=t.x+t.halfWidth-r.halfWidth+i,r.y=t.y-r.height+n,e.compensateForParentPosition(t,r)},e.putRight=function(r,i,n){i=i||0,n=n||0,r.x=t.x+t.width+i,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.putBottom=function(r,i,n){i=i||0,n=n||0,r.x=t.x+t.halfWidth-r.halfWidth+i,r.y=t.y+t.height+n,e.compensateForParentPosition(t,r)},e.putLeft=function(r,i,n){i=i||0,n=n||0,r.x=t.x-r.width+i,r.y=t.y+t.halfHeight-r.halfHeight+n,e.compensateForParentPosition(t,r)},e.compensateForParentPosition=function(e,t){0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(e,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return e.parent._alpha*e._alpha},set:function(t){e._alpha=t},enumerable:!0,configurable:!0},halfWidth:{get:function(){return e.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return e.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x+e.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y+e.halfHeight},enumerable:!0,configurable:!0},layer:{get:function(){return e._layer},set:function(t){e._layer=t,e.parent.children.sort(p)},enumerable:!0,configurable:!0},circular:{get:function(){return e._circular},set:function(t){!0===t&&!1===e._circular&&(c(e),e._circular=!0),!1===t&&!0===e._circular&&(delete e.diameter,delete e.radius,e._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return e._draggable},set:function(t){!0===t&&(d.draggableSprites.push(e),e._draggable=!0,!1===d.dragAndDrop&&(d.dragAndDrop=!0)),!1===t&&d.draggableSprites.splice(d.draggableSprites.indexOf(e),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return e._interactive},set:function(t){!0===t&&(h(e),e._interactive=!0),!1===t&&(d.buttons.splice(d.buttons.indexOf(e),1),e._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:e.width,height:e.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:e.gx,y:e.gy,width:e.gx+e.width,height:e.gy+e.height},rectangle},enumerable:!0,configurable:!0},empty:{get:function(){return 0===e.children.length},enumerable:!0,configurable:!0}})}function c(e){Object.defineProperties(e,{diameter:{get:function(){return e.width},set:function(t){e.width=t,e.height=t},enumerable:!0,configurable:!0},radius:{get:function(){return e.width/2},set:function(t){e.width=2*t,e.height=2*t},enumerable:!0,configurable:!0}})}function h(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.pressed=!1,e.enabled=!0,e.hoverOver=!1,d.buttons.push(e),e.update=function(t,r){if(e.enabled){var i=d.pointer.hitTestSprite(e);t.isUp&&(e.state="up","button"===e.subtype&&e.show(0)),i&&(e.state="over",e.frames&&3===e.frames.length&&"button"===e.subtype&&e.show(1),t.isDown&&(e.state="down","button"===e.subtype&&(3===e.frames.length?e.show(2):e.show(1)))),"down"===e.state&&(e.pressed||(e.press&&e.press(),e.pressed=!0,e.action="pressed")),"over"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released",d.pointer.tapped&&e.tap&&e.tap()),e.hoverOver||(e.over&&e.over(),e.hoverOver=!0)),"up"===e.state&&(e.pressed&&(e.release&&e.release(),e.pressed=!1,e.action="released"),e.hoverOver&&(e.out&&e.out(),e.hoverOver=!1))}}}function f(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function p(e,t){return e.layer<t.layer?-1:(e.layer,t.layer,1)}var d={};if(d.canvas=document.createElement("canvas"),d.canvas.setAttribute("width",1*e),d.canvas.setAttribute("height",1*t),d.canvas.style.backgroundColor="black",document.body.appendChild(d.canvas),d.canvas.ctx=d.canvas.getContext("2d"),d.stage=function(){var e={};return u(e),e.stage=!0,e.width=d.canvas.width,e.height=d.canvas.height,e.x=0,e.y=0,e.parent=void 0,e}(),d.pointer=function(){var e={};return e._x=0,e._y=0,Object.defineProperties(e,{x:{get:function(){return e._x/d.scale},enumerable:!0,configurable:!0},y:{get:function(){return e._y/d.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return e.x},enumerable:!0,configurable:!0},centerY:{get:function(){return e.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:e.x,y:e.y}},enumerable:!0,configurable:!0}}),e.isDown=!1,e.isUp=!0,e.tapped=!1,e.downTime=0,e.elapsedTime=0,e.press=void 0,e.release=void 0,e.tap=void 0,e.dragSprite=null,e.dragOffsetX=0,e.dragOffsetY=0,e.moveHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,t.preventDefault()},e.touchmoveHandler=function(t){e._x=t.targetTouches[0].pageX-d.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-d.canvas.offsetTop,t.preventDefault()},e.downHandler=function(t){e._x=t.pageX-t.target.offsetLeft,e._y=t.pageY-t.target.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.touchstartHandler=function(t){e._x=t.targetTouches[0].pageX-d.canvas.offsetLeft,e._y=t.targetTouches[0].pageY-d.canvas.offsetTop,e.isDown=!0,e.isUp=!1,e.tapped=!1,e.downTime=Date.now(),e.press&&e.press(),t.preventDefault()},e.upHandler=function(t){e.elapsedTime=Math.abs(e.downTime-Date.now()),e.elapsedTime<=200&&(e.tapped=!0,e.tap&&e.tap()),e.isUp=!0,e.isDown=!1,e.release&&e.release(),t.preventDefault()},d.canvas.addEventListener("mousemove",e.moveHandler.bind(e),!1),d.canvas.addEventListener("mousedown",e.downHandler.bind(e),!1),window.addEventListener("mouseup",e.upHandler.bind(e),!1),d.canvas.addEventListener("touchmove",e.touchmoveHandler.bind(e),!1),d.canvas.addEventListener("touchstart",e.touchstartHandler.bind(e),!1),window.addEventListener("touchend",e.upHandler.bind(e),!1),d.canvas.style.touchAction="none",e.hitTestSprite=function(t){var r=!1;if(t.circular){var i=e.x-(t.gx+t.halfWidth),n=e.y-(t.gy+t.halfHeight);r=Math.sqrt(i*i+n*n)<t.radius}else var o=t.gx,a=t.gx+t.width,s=t.gy,l=t.gy+t.height,r=e.x>o&&e.x<a&&e.y>s&&e.y<l;return r},e.updateDragAndDrop=function(){if(e.isDown)if(null===e.dragSprite)for(var t=d.draggableSprites.length-1;t>-1;t--){var r=d.draggableSprites[t];if(r.draggable&&e.hitTestSprite(r)){e.dragOffsetX=e.x-r.gx,e.dragOffsetY=e.y-r.gy,e.dragSprite=r;var i=r.parent.children;i.splice(i.indexOf(r),1),i.push(r),d.draggableSprites.splice(d.draggableSprites.indexOf(r),1),d.draggableSprites.push(r);break}}else e.dragSprite.x=e.x-e.dragOffsetX,e.dragSprite.y=e.y-e.dragOffsetY;e.isUp&&(e.dragSprite=null),d.draggableSprites.some(function(t){return t.draggable&&e.hitTestSprite(t)?(d.canvas.style.cursor="pointer",!0):(d.canvas.style.cursor="auto",!1)})},e}(),d.key=function(){var e={};return e.leftArrow=f(37),e.upArrow=f(38),e.rightArrow=f(39),e.downArrow=f(40),e.space=f(32),e}(),d.buttons=[],d.dragAndDrop=!1,d.draggableSprites=[],d.tweens=[],d.state=void 0,d.load=o||void 0,d.setup=i||void 0,void 0===d.setup)throw new Error("Please supply the setup function in the constructor");return d.assetFilePaths=n||void 0,d.paused=!1,d._fps=60,d._startTime=Date.now(),d._frameDuration=1e3/d._fps,d._lag=0,d.interpolate=!0,d.updateFunctions=[],d.scale=1,d.start=function(){d.assetFilePaths?(d.assets.whenLoaded=function(){d.state=void 0,d.setup()},d.assets.load(d.assetFilePaths),d.load&&(d.state=d.load)):d.setup(),a()},d.pause=function(){d.paused=!0},d.resume=function(){d.paused=!1},d.hidePointer=function(){d.canvas.style.cursor="none"},d.showPointer=function(){d.canvas.style.cursor="auto"},Object.defineProperties(d,{fps:{get:function(){return d._fps},set:function(e){d._fps=e,d._startTime=Date.now(),d._frameDuration=1e3/d._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){d.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),d.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var r=t[0];if(r.length>0)for(var i=r.length-1;i>=0;i--){var n=r[i];n.parent.removeChild(n),r.splice(r.indexOf(n),1)}}else t.length>1?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},d.group=function(e){var t={};if(u(t),t.addChild=function(e){e.parent&&e.parent.removeChild(e),e.parent=t,t.children.push(e),t.calculateSize()},t.removeChild=function(e){if(e.parent!==t)throw new Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=function(){t.children.length>0&&(t._newWidth=0,t._newHeight=0,t.children.forEach(function(e){e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},d.stage.addChild(t),e){Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)})}return t},d.rectangle=function(e,t,r,i,n,o,a){var s={};return u(s),s.mask=!1,s.width=e||32,s.height=t||32,s.fillStyle=r||"red",s.strokeStyle=i||"none",s.lineWidth=n||0,s.x=o||0,s.y=a||0,d.stage.addChild(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.rect(-s.width*s.pivotX,-s.height*s.pivotY,s.width,s.height),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},d.circle=function(e,t,r,i,n,o){var a={};return u(a),a.mask=!1,a.width=e||32,a.height=e||32,a.fillStyle=t||"red",a.strokeStyle=r||"none",a.lineWidth=i||"none",a.x=n||0,a.y=o||0,d.stage.addChild(a),c(a),a.render=function(e){e.strokeStyle=a.strokeStyle,e.lineWidth=a.lineWidth,e.fillStyle=a.fillStyle,e.beginPath(),e.arc(a.radius+-a.diameter*a.pivotX,a.radius+-a.diameter*a.pivotY,a.radius,0,2*Math.PI,!1),!0===a.mask?e.clip():("none"!==a.strokeStyle&&e.stroke(),"none"!==a.fillStyle&&e.fill())},a},d.line=function(e,t,r,i,n,o){var a={};return u(a),r||0===r||(r=0),i||0===i||(i=0),n||0===n||(n=32),o||0===o||(o=32),a.ax=r,a.ay=i,a.bx=n,a.by=o,a.strokeStyle=e||"red",a.lineWidth=t||1,a.lineJoin="round",d.stage.addChild(a),a.render=function(e){e.strokeStyle=a.strokeStyle,e.lineWidth=a.lineWidth,e.lineJoin=a.lineJoin,e.beginPath(),e.moveTo(a.ax,a.ay),e.lineTo(a.bx,a.by),"none"!==a.strokeStyle&&e.stroke(),"none"!==a.fillStyle&&e.fill()},a},d.text=function(e,t,r,i,n){var o={};return u(o),o.content=e||"Hello!",o.font=t||"12px sans-serif",o.fillStyle=r||"red",o.textBaseline="top",Object.defineProperties(o,{width:{get:function(){return d.canvas.ctx.measureText(o.content).width},enumerable:!0,configurable:!0},height:{get:function(){return d.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),d.stage.addChild(o),o.x=i||0,o.y=n||0,o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,0===o.width&&(o.width=e.measureText(o.content).width),0===o.height&&(o.height=e.measureText("M").width),e.translate(-o.width*o.pivotX,-o.height*o.pivotY),e.font=o.font,e.textBaseline=o.textBaseline,e.fillText(o.content,0,0)},o},d.frame=function(e,t,r,i,n){var o={};return o.image=e,o.x=t,o.y=r,o.width=i,o.height=n,o},d.frames=function(e,t,r,i){var n={};return n.image=e,n.data=t,n.width=r,n.height=i,n},d.filmstrip=function(e,t,r,i){for(var n=d.assets[e].source,o=[],a=n.width/t,s=n.height/r,l=a*s,u=0;u<l;u++){var c,h;c=u%a*t,h=Math.floor(u/a)*r,i&&i>0&&(c+=i+i*u%a,h+=i+i*Math.floor(u/a)),o.push([c,h])}return d.frames(e,o,t,r)},d.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return u(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.image&&!e.data){if(!(d.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=d.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e.image&&e.data&&(t.source=d.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else e instanceof Array?(t.frames=e,t.source=d.assets[e[0]].source,t.sourceX=d.assets[e[0]].frame.x,t.sourceY=d.assets[e[0]].frame.y,t.width=d.assets[e[0]].frame.w,t.height=d.assets[e[0]].frame.h,t.sourceWidth=d.assets[e[0]].frame.w,t.sourceHeight=d.assets[e[0]].frame.h):(t.tilesetFrame=d.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(t.frames.length>0))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):d.assets[t.frames[e]].frame&&(t.source=d.assets[t.frames[e]].source,t.sourceX=d.assets[t.frames[e]].frame.x,t.sourceY=d.assets[t.frames[e]].frame.y,t.sourceWidth=d.assets[t.frames[e]].frame.w,t.sourceHeight=d.assets[t.frames[e]].frame.h,t.width=d.assets[t.frames[e]].frame.w,t.height=d.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,t.y=0,t.frames.length>0&&(d.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),d.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},d.button=function(e){var t=d.sprite(e);return t.subtype="button",h(t),t},d.image=function(e){return d.assets[e]},d.json=function(e){return d.assets[e]},d.addStatePlayer=function(e){function t(t){a(),"string"!=typeof t?e.gotoAndStop(t):e.gotoAndStop(e.frames.indexOf(t))}function r(){n([0,e.frames.length-1])}function i(){a(),e.gotoAndStop(e.currentFrame)}function n(t){a(),u=t[0],c=t[1],l=c-u,0===u&&(l+=1,s+=1),1===l&&(l=2,s+=1),e.fps||(e.fps=12);var r=1e3/e.fps;e.gotoAndStop(u),f||(h=setInterval(o.bind(this),r),f=!0)}function o(){s<l?(e.gotoAndStop(e.currentFrame+1),s+=1):e.loop&&(e.gotoAndStop(u),s=1)}function a(){void 0!==h&&!0===f&&(f=!1,s=0,u=0,c=0,l=0,clearInterval(h))}var s=0,l=0,u=0,c=0,h=void 0,f=!1;e.show=t,e.play=r,e.stop=i,e.playing=f,e.playSequence=n},d.render=function(e,t){function r(n){if(n.visible&&n.gx<e.width+n.width&&n.gx+n.width>=-n.width&&n.gy<e.height+n.height&&n.gy+n.height>=-n.height){if(i.save(),d.interpolate?(void 0!==n._previousX?n.renderX=(n.x-n._previousX)*t+n._previousX:n.renderX=n.x,void 0!==n._previousY?n.renderY=(n.y-n._previousY)*t+n._previousY:n.renderY=n.y):(n.renderX=n.x,n.renderY=n.y),i.translate(n.renderX+n.width*n.pivotX,n.renderY+n.height*n.pivotY),i.globalAlpha=n.alpha,i.rotate(n.rotation),i.scale(n.scaleX,n.scaleY),n.shadow&&(i.shadowColor=n.shadowColor,i.shadowOffsetX=n.shadowOffsetX,i.shadowOffsetY=n.shadowOffsetY,i.shadowBlur=n.shadowBlur),n.blendMode&&(i.globalCompositeOperation=n.blendMode),n.render&&n.render(i),n.children&&n.children.length>0){i.translate(-n.width*n.pivotX,-n.height*n.pivotY);for(var o=0;o<n.children.length;o++){r(n.children[o])}}i.restore()}}var i=e.ctx;i.clearRect(0,0,e.width,e.height);for(var n=0;n<d.stage.children.length;n++){r(d.stage.children[n])}},d.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(e){console.log("Loading assets...");var t=this;t.toLoad=e.length,e.forEach(function(e){var r=e.split(".").pop();if(-1!==t.imageExtensions.indexOf(r)){var i=new Image;i.addEventListener("load",function(){i.name=e,t[i.name]={source:i,frame:{x:0,y:0,w:i.width,h:i.height}},t.loadHandler()},!1),i.src=e}else if(-1!==t.fontExtensions.indexOf(r)){var n=e.split("/").pop().split(".")[0],o=document.createElement("style"),a="@font-face {font-family: '"+n+"'; src: url('"+e+"');}";o.appendChild(document.createTextNode(a)),document.head.appendChild(o),t.loadHandler()}else if(-1!==t.audioExtensions.indexOf(r)){var s=d.makeSound(e,t.loadHandler.bind(t));s.name=e,t[s.name]=s}else if(-1!==t.jsonExtensions.indexOf(r)){var l=new XMLHttpRequest,u={};l.open("GET",e,!0),l.addEventListener("readystatechange",function(){200===l.status&&4===l.readyState&&(u=JSON.parse(l.responseText),u.name=e,t[u.name]=u,u.frames?t.createTilesetFrames(u,e):t.loadHandler())}),l.send()}else console.log("File type not recognized: "+e)})},createTilesetFrames:function(e,t){function r(){i[n+e.meta.image]={source:o,frame:{x:0,y:0,w:o.width,h:o.height}},Object.keys(e.frames).forEach(function(t){i[t]=e.frames[t],i[t].source=o}),i.loadHandler()}var i=this,n=t.replace(/[^\/]*$/,""),o=new Image;o.addEventListener("load",r,!1),o.src=n+e.meta.image},loadHandler:function(){var e=this;e.loaded+=1,console.log(e.loaded),e.toLoad===e.loaded&&(e.toLoad=0,e.loaded=0,e.whenLoaded())}},d.keyboard=f,d.makeDisplayObject=u,void 0!==r.plugins&&r.plugins(d),void 0!==r.custom&&r.custom(d),d},window.ga=r.create,window.GA=r},function(e,t,r){"use strict";var i=r(16),n=function(e){return e&&e.__esModule?e:{default:e}}(i);r(13),r(12);var o=window.ga,a=o(768,800,function(){a.canvas.style.border="2px black solid",a.canvas.style.display="block",a.canvas.style.margin="auto",a.backgroundColor="white",a.state=(0,n.default)(a)});a.start()},function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=r(5),a=function(e){return e&&e.__esModule?e:{default:e}}(o),s=r(2),l=function(){function e(t){i(this,e),this.g=t,this.items=[],this.cursorPosition=0,this.textUtil=new a.default(t),this.textSize=48,this.verticalSpacing=64,this.initInput()}return n(e,[{key:"initInput",value:function(){var e=this;this.controls=(0,s.getPlayerControls)(this.g,1),this.controls.up.press=function(){0===e.cursorPosition?e.cursorPosition=e.items.length-1:e.cursorPosition-=1},this.controls.down.press=function(){e.cursorPosition===e.items.length-1?e.cursorPosition=0:e.cursorPosition+=1},this.controls.action.press=function(){e.textUtil.clear(),e.controls.action.press=null,e.items[e.cursorPosition].callback()}}},{key:"setYPosition",value:function(e){this.y=e}},{key:"addItem",value:function(e,t){this.items.push({text:e,callback:t})}},{key:"draw",value:function(){this.cursor||(this.texts=this.textUtil.createHorizontallyCenteredTexts(this.items.map(function(e){return e.text}),this.textSize,"#000000",this.y,this.verticalSpacing),this.cursor=this.textUtil.createText("=>",this.textSize,"#000000",this.texts[0].x-this.verticalSpacing,this.y+this.verticalSpacing*this.cursorPosition)),this.cursor.y=this.y+this.verticalSpacing*this.cursorPosition}}]),e}();t.default=l},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=(r(2),r(8)),o=i(n),a=r(5),s=i(a),l=r(15),u=i(l);t.default=function(e){var t=new s.default(e),r=(t.createHorizontallyCenteredText("Splat Paddlers!",64,"#000000",20),new u.default(e));return r.setYPosition(256),r.addItem("2 Players",function(){e.globals={players:2},t.clear(),e.state=(0,o.default)(e)}),r.addItem("4 Players (Teams)",function(){e.globals={players:4,teams:!0},t.clear(),e.state=(0,o.default)(e)}),r.addItem("4 Players (VS)",function(){e.globals={players:4,teams:!1},t.clear(),e.state=(0,o.default)(e)}),function(){r.draw()}}},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=r(5),o=i(n),a=r(8),s=i(a),l=(r(2),r(11));e.exports=function(e){var t={};e.collisionGroups.paddle.forEach(function(e){t[e.color]=0}),e.collisionGroups.block.forEach(function(e){"blank"!==e.color&&(t[e.color]+=1)}),e.things.forEach(function(e){return e.remove()});var r=Object.keys(t).map(function(e){return{color:e,score:t[e]}}).sort(function(e,t){return t.score-e.score}),i=r.reduce(function(e,t){return t.color.length>e?t.color.length:e},r[0].color.length),n=r.reduce(function(e,t){return t.score.toString().length>e?t.score.toString().length:e},r[0].score.toString().length),a=new o.default(e),u=[];u.push(a.createHorizontallyCenteredText("Round score",48,"#000000",128));var c=r.map(function(e){var t=e.score,r=e.color;return(0,l.rpad)(""+r,i+1)+(0,l.lpad)(""+t,n)});return u.push.apply(u,a.createHorizontallyCenteredTexts(c,36,"#000000",192,48)),e.wait(3e3,function(){u.forEach(function(t){return e.remove(t)}),e.state=(0,s.default)(e)}),function(){}}}]);